import { onApplySuccess } from "./query.js"

const attributes = [
    "american",
    "apple",
    "arched",
    "bald",
    "bare",
    "black",
    "blonde",
    "blue",
    "blurry",
    "brick",
    "bright",
    "brown",
    "calm",
    "cardboard",
    "chocolate",
    "clear",
    "closed",
    "cloudy",
    "colorful",
    "concrete",
    "curly",
    "dark",
    "digital",
    "distant",
    "double decker",
    "eating",
    "empty",
    "floral",
    "fluffy",
    "flying",
    "framed",
    "glass",
    "gold",
    "gray",
    "green",
    "hairy",
    "hanging",
    "large",
    "leather",
    "lit",
    "little",
    "long",
    "metal",
    "open",
    "orange",
    "parked",
    "pink",
    "plaid",
    "plastic",
    "potted",
    "purple",
    "red",
    "riding",
    "rocky",
    "round",
    "silver",
    "sitting",
    "small",
    "stacked",
    "standing",
    "stone",
    "striped",
    "stuffed",
    "tall",
    "tan",
    "tiled",
    "walking",
    "watching",
    "wet",
    "white",
    "wooden",
    "yellow"
];

const concepts = [
    "air conditioner",
    "airplane",
    "airport",
    "antenna",
    "apple",
    "apples",
    "apron",
    "arch",
    "arm",
    "arrow",
    "awning",
    "back",
    "background",
    "backpack",
    "bacon",
    "bag",
    "balcony",
    "ball",
    "balloon",
    "balloons",
    "balls",
    "banana",
    "bananas",
    "banner",
    "bar",
    "barrel",
    "barrier",
    "base",
    "basket",
    "bat",
    "bathroom",
    "bathtub",
    "beach",
    "beam",
    "beams",
    "beans",
    "bear",
    "beard",
    "bed",
    "bedroom",
    "beer",
    "bell",
    "belt",
    "bench",
    "berries",
    "bicycle",
    "bicycles",
    "bike",
    "bikes",
    "billboard",
    "bird",
    "blade",
    "blanket",
    "blender",
    "blinds",
    "block",
    "board",
    "boat",
    "book",
    "books",
    "bookshelf",
    "boot",
    "boots",
    "bottle",
    "bottles",
    "bouquet",
    "bow",
    "bowl",
    "bowls",
    "box",
    "boxes",
    "boy",
    "bracelet",
    "branch",
    "bread",
    "bricks",
    "bridge",
    "broccoli",
    "brush",
    "bucket",
    "buckle",
    "building",
    "bumper",
    "bun",
    "burger",
    "burner",
    "bus",
    "bus stop",
    "buses",
    "bush",
    "bushes",
    "butter",
    "button",
    "buttons",
    "cabinet",
    "cabinets",
    "cake",
    "calendar",
    "camera",
    "can",
    "candle",
    "cap",
    "car",
    "card",
    "carpet",
    "carrot",
    "carrots",
    "cars",
    "cart",
    "case",
    "cat",
    "cd",
    "ceiling",
    "cellphone",
    "chain",
    "chair",
    "chairs",
    "chandelier",
    "chimney",
    "chin",
    "chopsticks",
    "christmas tree",
    "church",
    "circle",
    "city",
    "clock",
    "clocks",
    "closet",
    "cloth",
    "clothes",
    "cloud",
    "clouds",
    "coaster",
    "coat",
    "coffee",
    "coffee maker",
    "collar",
    "column",
    "computer",
    "computer monitor",
    "computers",
    "cone",
    "cones",
    "container",
    "containers",
    "control panel",
    "controller",
    "cookie",
    "cooler",
    "cord",
    "cords",
    "couch",
    "counter",
    "cow",
    "crane",
    "crosswalk",
    "crumbs",
    "cucumber",
    "cuff",
    "cup",
    "cupcake",
    "curb",
    "curtain",
    "cushion",
    "cutting board",
    "dashboard",
    "design",
    "desk",
    "device",
    "dial",
    "diamond",
    "dish",
    "dishes",
    "dishwasher",
    "display",
    "dog",
    "doll",
    "donut",
    "donuts",
    "door",
    "doors",
    "doorway",
    "dot",
    "drain",
    "drawer",
    "drawers",
    "drawing",
    "dress",
    "dresser",
    "drinks",
    "dumpster",
    "dvd player",
    "ear",
    "earring",
    "egg",
    "eggs",
    "elephant",
    "engine",
    "entertainment center",
    "eye",
    "eyes",
    "face",
    "facial hair",
    "fan",
    "faucet",
    "feet",
    "fence",
    "field",
    "figurine",
    "finger",
    "fingers",
    "fire extinguisher",
    "fire hydrant",
    "fireplace",
    "fish",
    "flag",
    "flags",
    "floor",
    "flower",
    "flowers",
    "food",
    "foot",
    "fork",
    "fountain",
    "frame",
    "freezer",
    "french fries",
    "fries",
    "frisbee",
    "fruit",
    "game",
    "garden",
    "gate",
    "girl",
    "glass",
    "glasses",
    "glove",
    "graffiti",
    "grape",
    "grapes",
    "grass",
    "grate",
    "gravel",
    "grill",
    "ground",
    "hair",
    "hair dryer",
    "hallway",
    "hand",
    "handle",
    "handles",
    "hands",
    "hat",
    "hay",
    "head",
    "headband",
    "headboard",
    "headlight",
    "headlights",
    "headphones",
    "heart",
    "heater",
    "hedge",
    "helmet",
    "hill",
    "holder",
    "hole",
    "hood",
    "hoodie",
    "hook",
    "horse",
    "hose",
    "hot dog",
    "house",
    "icons",
    "ipod",
    "jacket",
    "jar",
    "jeans",
    "jersey",
    "jug",
    "key",
    "keyboard",
    "keypad",
    "keys",
    "kitchen",
    "kite",
    "knee",
    "knife",
    "knives",
    "knob",
    "knobs",
    "label",
    "ladder",
    "lamp",
    "lamp shade",
    "lanyard",
    "laptop",
    "leaf",
    "leash",
    "leaves",
    "leg",
    "legs",
    "lemon",
    "letter",
    "letters",
    "lettuce",
    "license plate",
    "lid",
    "light",
    "light switch",
    "lights",
    "lime",
    "line",
    "lines",
    "lips",
    "liquid",
    "logo",
    "luggage",
    "machine",
    "magazine",
    "magnet",
    "magnets",
    "mailbox",
    "man",
    "manhole",
    "mantle",
    "map",
    "mask",
    "mat",
    "meat",
    "median",
    "men",
    "menu",
    "microphone",
    "microwave",
    "mirror",
    "monitor",
    "moon",
    "motorcycle",
    "mountain",
    "mouse",
    "mouse pad",
    "mouth",
    "mug",
    "nail",
    "napkin",
    "neck",
    "necklace",
    "net",
    "newspaper",
    "nightstand",
    "nose",
    "notebook",
    "number",
    "numbers",
    "office",
    "office chair",
    "olive",
    "orange",
    "oranges",
    "ottoman",
    "outlet",
    "oven",
    "pad",
    "page",
    "paint",
    "painting",
    "palm",
    "palm tree",
    "pan",
    "pants",
    "paper",
    "paper towels",
    "papers",
    "park",
    "parking lot",
    "parking meter",
    "path",
    "paw",
    "pen",
    "pens",
    "people",
    "pepperoni",
    "person",
    "phone",
    "picture",
    "pictures",
    "pier",
    "pillar",
    "pillow",
    "pillows",
    "pilot",
    "pineapple",
    "pipe",
    "pitcher",
    "pizza",
    "placemat",
    "plane",
    "plant",
    "planter",
    "plants",
    "plaque",
    "plate",
    "plates",
    "platform",
    "player",
    "plug",
    "pocket",
    "pole",
    "post",
    "poster",
    "pot",
    "potato",
    "printer",
    "purse",
    "quilt",
    "rack",
    "racket",
    "radiator",
    "radio",
    "rail",
    "railing",
    "rain",
    "ramp",
    "reflection",
    "refrigerator",
    "remote",
    "remote control",
    "restaurant",
    "rice",
    "ring",
    "road",
    "robe",
    "rock",
    "rocks",
    "rod",
    "roof",
    "room",
    "rope",
    "rose",
    "rug",
    "salad",
    "salt shaker",
    "sandal",
    "sandwich",
    "sauce",
    "saucer",
    "sausage",
    "scarf",
    "scene",
    "scissors",
    "scooter",
    "scoreboard",
    "screen",
    "screw",
    "sculpture",
    "seat",
    "seats",
    "shade",
    "shadow",
    "sheep",
    "sheet",
    "shelf",
    "shelves",
    "ship",
    "shirt",
    "shoe",
    "shoes",
    "shorts",
    "shower curtain",
    "shutter",
    "sidewalk",
    "sign",
    "signs",
    "sink",
    "skateboard",
    "ski",
    "skin",
    "skirt",
    "sky",
    "sleeve",
    "smoke",
    "snow",
    "snowboard",
    "sock",
    "socket",
    "socks",
    "sofa",
    "soup",
    "speaker",
    "speakers",
    "spoon",
    "spot",
    "spots",
    "stack",
    "staircase",
    "stairs",
    "stand",
    "star",
    "station",
    "statue",
    "steeple",
    "steering wheel",
    "stem",
    "stems",
    "steps",
    "stick",
    "sticker",
    "stone",
    "stool",
    "stop sign",
    "store",
    "stove",
    "strap",
    "straw",
    "strawberries",
    "strawberry",
    "street",
    "streetlight",
    "strings",
    "stripe",
    "stripes",
    "stroller",
    "stuffed animal",
    "stuffed animals",
    "stump",
    "suit",
    "suitcase",
    "sun",
    "sunglasses",
    "sunset",
    "surfboard",
    "suv",
    "sweater",
    "table",
    "tablet",
    "tag",
    "tail",
    "tail light",
    "tank",
    "tank top",
    "tarmac",
    "teapot",
    "teeth",
    "telephone",
    "television",
    "tent",
    "text",
    "thumb",
    "tie",
    "tights",
    "tile",
    "tiles",
    "tines",
    "tire",
    "tires",
    "toaster",
    "toilet",
    "toilet paper",
    "tomato",
    "tongs",
    "tongue",
    "toothbrush",
    "toothpaste",
    "top",
    "towel",
    "tower",
    "toy",
    "tracks",
    "traffic light",
    "train",
    "train station",
    "trash can",
    "tray",
    "tree",
    "trees",
    "triangle",
    "truck",
    "trunk",
    "tshirt",
    "tunnel",
    "tusk",
    "umbrella",
    "urinal",
    "van",
    "vase",
    "vehicle",
    "vent",
    "vest",
    "wall",
    "wallet",
    "washer",
    "watch",
    "water",
    "water bottle",
    "wheel",
    "wheels",
    "wii",
    "window",
    "windows",
    "windshield",
    "wine",
    "wine glass",
    "wing",
    "wire",
    "wires",
    "woman",
    "wood",
    "woods",
    "wrapper",
    "wrist",
    "writing",
    "yellow",
    "zebra"
];

const categories = [
    "airfield",
    "airplane cabin",
    "airport terminal",
    "art gallery",
    "bank vault",
    "bar",
    "bathroom",
    "beach",
    "bedroom",
    "bus interior",
    "bus station/indoor",
    "cafeteria",
    "campus",
    "car interior",
    "cemetery",
    "church/indoor",
    "classroom",
    "clothing store",
    "coast",
    "coffee shop",
    "conference center",
    "conference room",
    "dining room",
    "elevator/door",
    "elevator lobby",
    "entrance hall",
    "food court",
    "garage/indoor",
    "gas station",
    "general store/indoor",
    "general store/outdoor",
    "gift shop",
    "home office",
    "hotel/outdoor",
    "hotel room",
    "house",
    "kitchen",
    "lecture room",
    "living room",
    "lobby",
    "mountain",
    "office",
    "office building",
    "office cubicles",
    "park",
    "parking garage/indoor",
    "parking garage/outdoor",
    "parking lot",
    "reception",
    "restaurant",
    "river",
    "roof garden",
    "shopping mall/indoor",
    "storage room",
    "street",
    "subway station/platform",
    "supermarket",
    "television room",
    "train interior",
    "train station/platform",
    "yard"
];

var sendApplyFilterQuery = function (listFilter) {
    $('.loader-wrapper').removeClass('custom-hidden');

    $.post("http://localhost:5000/filter", { 'filter[]': listFilter })
        .done(onApplySuccess)
        .fail((xhr, status, error) => {
            $('.loader-wrapper').addClass('custom-hidden');
            alert('Query failed!\n');
            console.log(JSON.stringify(xhr));
            console.log(status);
            console.log(error);
        });
}

var onApplyFilterBtnClick = function () {
    console.log('List filter:');

    var listFilter = [];
    $('#tag-holder span').each(function () {
        var filterData = $(this).data('tag-id');
        // console.log(filterData);
        listFilter.push(filterData)
    });

    $('#text-value-holder>div').each(function () {
        var filterData = $(this).data('tag-id');
        // console.log(filterData);
        listFilter.push(filterData)
    });

    console.log(listFilter);

    if (listFilter.length > 0) {
        sendApplyFilterQuery(listFilter);
    }
}

function handleFilterUI() {
    concepts.forEach(function (concept) {
        let elId = concept.split(' ').join('-')
        let elValue = concept.toLowerCase()
        $('#object-value-holder').append(`
        <div>
            <input type="checkbox" value="${elValue}" id="object-${elId}" data-tag-name="${concept}">
            <label for="object-${elId}">${concept}</label>
        </div>
        `);
    });

    categories.forEach(function (category) {
        let elValue = category.split(' ').join('-')
        let elId = elValue.split('/').join('-')
        $('#place-value-holder').append(`
        <div>
            <input type="checkbox" value="place-${elValue}" id="place-${elId}" data-tag-name="${category}">
            <label for="place-${elId}">${category}</label>
        </div>
        `);
    });

    attributes.forEach(function (attribute) {
        let elId = attribute.split(' ').join('-')
        let elValue = attribute.toLowerCase()
        $('#attribute-value-holder').append(`
        <div>
            <input type="checkbox" value="${elValue}" id="attribute-${elId}" data-tag-name="${attribute}">
            <label for="attribute-${elId}">${attribute}</label>
        </div>
        `);
    });

    var applyFilterBtn = $("#apply-filter-btn");
    applyFilterBtn.click(onApplyFilterBtnClick);

    $('#text-filter-input').keyup(function (e) {
        if (e.keyCode == 13) {
            var textValue = $(this).val()
            $('#text-value-holder').append(`
            <div class="bg-light border mb-1 px-2 d-flex justify-content-between align-items-center" data-tag-id="text-location-${textValue.toLowerCase().split(' ').join('-')}">
                <span>${textValue}</span>
                <i class="fa fa-times" aria-hidden="true"></i>
            </div>
            `);
            $('#text-value-holder>div:last').click(function () {
                $(this).remove();
            });
            $(this).val('')
        }
    });

    $('.filter-search').keyup(function(e) {
        $(this).parent().parent().find('.value-holder>div').removeClass('custom-hidden');
        var keyword = $(this).val();
        if (keyword == '') {
            return;
        }
        // console.log(keyword);
        $(this).parent().parent().find('.value-holder>div').each(function() {
            var tag = $(this).children('label').text()
            // console.log(tag);
            if (!tag.includes(keyword)) {
                $(this).addClass('custom-hidden');
            }
        });
    });
}

export { handleFilterUI }